<!doctype html>
<html lang="et">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kaisukapood ‚Äì eurode ja sentide √µppem√§ng</title>
  <style>
    :root { --bg:#fff; --fg:#111; --muted:#6b7280; --brand:#6366f1; --ok:#16a34a; --bad:#dc2626; --card:#f8fafc; --line:#e5e7eb;}
    * { box-sizing:border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--fg); background:var(--bg); }
    .wrap { max-width: 980px; margin: 24px auto; padding: 0 16px; }
    h1 { font-size: 24px; margin: 0 0 12px; }
    .row { display:grid; grid-template-columns: 1fr; gap:16px; }
    @media (min-width: 880px){ .row { grid-template-columns: 320px 1fr; } }
    .card { background:var(--card); border:1px solid var(--line); border-radius:16px; padding:16px; }
    .btn { cursor:pointer; border:0; border-radius:10px; padding:10px 14px; background:var(--brand); color:#fff; font-weight:600; }
    .btn.alt { background:#10b981; }
    .btn.ghost { background:#fff; color:var(--fg); border:1px solid var(--line); }
    .btn + .btn { margin-left:8px; }
    .muted { color:var(--muted); }
    .shop { display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap:12px; }
    @media (min-width:700px){ .shop { grid-template-columns: repeat(4,minmax(0,1fr)); } }
    .item { background:#fff; border:1px solid var(--line); border-radius:14px; padding:10px; display:flex; flex-direction:column; align-items:center; gap:6px; }
    .item.selected { outline: 3px solid rgba(99,102,241,.35); }
    .price { font-size:14px; }
    .foot { border-top:1px dashed var(--line); padding-top:10px; margin-top:10px; }
    ul { margin:8px 0 0 18px; padding:0; }
    .state-ok { color:var(--ok); font-weight:700; }
    .state-bad { color:var(--bad); font-weight:700; }
    .toggle { display:inline-flex; gap:6px; align-items:center; }
    .toggle input { transform: scale(1.2); }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Euro-m√§ng: osta kaisukaid üß∏</h1>
    <p class="muted">Vajuta ‚ÄúAnna ‚Ç¨5‚Äù v√µi ‚ÄúAnna ‚Ç¨10‚Äù, loe koos lapsega paberraha ja sentide kaupa ning vali, millised kaisukad ta saab osta.</p>

    <div class="row">
      <!-- Rahakott -->
      <section class="card">
        <h2 style="margin-top:0">Rahakott</h2>
        <div style="margin:8px 0 12px">
          <button class="btn" id="give5">Anna ‚Ç¨5</button>
          <button class="btn alt" id="give10">Anna ‚Ç¨10</button>
          <button class="btn ghost" id="clear">T√ºhjenda</button>
        </div>

        <div>
          <div style="font-size:18px; margin-bottom:6px">Sinu raha: <strong id="wallet">‚Ç¨0.00</strong></div>

          <label class="toggle">
            <input type="checkbox" id="coinsOnly">
            <span>N√§ita lahutust ainult m√ºntidega (sentides)</span>
          </label>

          <div style="margin-top:10px">
            <div style="font-weight:600">Raha lahutus:</div>
            <ul id="walletBreakdown"><li>Puudub raha ‚Äî vajuta ‚ÄúAnna ‚Ç¨5‚Äù v√µi ‚ÄúAnna ‚Ç¨10‚Äù.</li></ul>
          </div>
        </div>
      </section>

      <!-- Pood -->
      <section class="card">
        <h2 style="margin-top:0">Kaisukate pood</h2>
        <div class="shop" id="shop"></div>

        <div class="foot">
          <div>Valitud kokku: <strong id="selTotal">‚Ç¨0.00</strong></div>
          <div>Kas saad osta? <strong id="afford" class="state-bad">Ei</strong></div>
          <div>Vahetus: <strong id="change">‚Ç¨0.00</strong></div>

          <div style="margin-top:8px">
            <div style="font-weight:600">Vahetuse lahutus:</div>
            <ul id="changeBreakdown"><li>Ei ole ostetud ‚Äî vahetust ei arvutata.</li></ul>
          </div>
        </div>
      </section>
    </div>

    <section class="card" style="margin-top:16px">
      <h3 style="margin:0">Kuidas m√§ngida</h3>
      <ol>
        <li>Anna lapsele raha (nupp ‚Ç¨5 v√µi ‚Ç¨10).</li>
        <li>Loendage koos lahutust: mitu paberraha ja mitme sendiga kokku saab.</li>
        <li>Valige kaisukad. Kui raha j√§tkub, n√§ete ‚ÄúJah‚Äù ja vahetuse summat ning selle lahutust.</li>
      </ol>
    </section>
  </div>

  <script>
    // ---- Andmed ----
    const BANKNOTES_COINS = [
      { value: 50000, label: "‚Ç¨500" },
      { value: 20000, label: "‚Ç¨200" },
      { value: 10000, label: "‚Ç¨100" },
      { value: 5000,  label: "‚Ç¨50"  },
      { value: 2000,  label: "‚Ç¨20"  },
      { value: 1000,  label: "‚Ç¨10"  },
      { value: 500,   label: "‚Ç¨5"   },
      { value: 200,   label: "‚Ç¨2"   },
      { value: 100,   label: "‚Ç¨1"   },
      { value: 50,    label: "50¬¢"  },
      { value: 20,    label: "20¬¢"  },
      { value: 10,    label: "10¬¢"  },
      { value: 5,     label: "5¬¢"   },
      { value: 2,     label: "2¬¢"   },
      { value: 1,     label: "1¬¢"   },
    ];

    // Armaste kaisukate hinnad (cents)
    const PLUSHIES = [
      { id: 1, name: "Pehme Karu",     priceCents: 250, svg: "bear"    },
      { id: 2, name: "V√§ike J√§nku",    priceCents: 150, svg: "bunny"   },
      { id: 3, name: "Sinine Draakon", priceCents: 400, svg: "dragon"  },
      { id: 4, name: "Roosa √úkssarvik",priceCents: 550, svg: "unicorn" },
    ];

    // ---- Abifunktsioonid ----
    const ‚Ç¨ = (c) => "‚Ç¨" + (c/100).toFixed(2);

    function greedyBreakdown(totalCents, coinsOnly=false){
      const units = coinsOnly
        ? BANKNOTES_COINS.filter(u => u.value < 500) // ainult m√ºndid
        : BANKNOTES_COINS;
      let r = totalCents, out = [];
      for(const u of units){
        const count = Math.floor(r / u.value);
        if(count > 0){ out.push({label:u.label, count}); r -= count*u.value; }
      }
      // kui valisid coinsOnly ja midagi j√§i √ºle (nt 0.03‚Ç¨ ja v√§ikseim √ºhik 1¬¢), r=0 alati
      return out;
    }

    function svg(kind){
      const common = 'width="100" height="100" viewBox="0 0 120 120"';
      if(kind==="bear") return `<svg ${common} xmlns="http://www.w3.org/2000/svg">
        <g fill="none" fill-rule="evenodd">
          <ellipse cx="60" cy="92" rx="36" ry="12" fill="#F4C2A1"/>
          <circle cx="40" cy="40" r="22" fill="#F5A97F"/>
          <circle cx="80" cy="40" r="22" fill="#F5A97F"/>
          <circle cx="60" cy="56" r="26" fill="#F5C6A0"/>
          <circle cx="52" cy="50" r="4" fill="#3B2F2F"/>
          <circle cx="68" cy="50" r="4" fill="#3B2F2F"/>
          <ellipse cx="60" cy="64" rx="8" ry="6" fill="#3B2F2F"/>
        </g></svg>`;
      if(kind==="bunny") return `<svg ${common} xmlns="http://www.w3.org/2000/svg">
        <g fill="none" fill-rule="evenodd">
          <ellipse cx="60" cy="96" rx="40" ry="10" fill="#EDE7F6"/>
          <ellipse cx="60" cy="56" rx="30" ry="28" fill="#FFF1F6"/>
          <ellipse cx="42" cy="36" rx="8" ry="22" fill="#FFF1F6" transform="rotate(-25 42 36)"/>
          <ellipse cx="78" cy="36" rx="8" ry="22" fill="#FFF1F6" transform="rotate(25 78 36)"/>
          <circle cx="52" cy="56" r="4" fill="#2B2B2B"/>
          <circle cx="68" cy="56" r="4" fill="#2B2B2B"/>
          <path d="M56 70c4 4 8 4 12 0" stroke="#2B2B2B" stroke-width="2" stroke-linecap="round"/>
        </g></svg>`;
      if(kind==="dragon") return `<svg ${common} xmlns="http://www.w3.org/2000/svg">
        <g fill="none" fill-rule="evenodd">
          <ellipse cx="60" cy="96" rx="36" ry="9" fill="#D0F0FF"/>
          <ellipse cx="60" cy="60" rx="32" ry="26" fill="#C3F7D6"/>
          <circle cx="44" cy="48" r="5" fill="#1F3B2E"/>
          <circle cx="76" cy="48" r="5" fill="#1F3B2E"/>
          <path d="M36 68c8 6 40 6 52 0" stroke="#1F3B2E" stroke-width="2" stroke-linecap="round"/>
          <path d="M18 60c8-12 18-18 24-20" stroke="#9AE3B4" stroke-width="4" stroke-linecap="round"/>
        </g></svg>`;
      if(kind==="unicorn") return `<svg ${common} xmlns="http://www.w3.org/2000/svg">
        <g fill="none" fill-rule="evenodd">
          <ellipse cx="60" cy="96" rx="36" ry="9" fill="#FFE8F0"/>
          <ellipse cx="60" cy="58" rx="32" ry="28" fill="#FFF1FF"/>
          <path d="M46 36c4-10 28-26 36 0" stroke="#FFD1E6" stroke-width="6" stroke-linecap="round"/>
          <circle cx="48" cy="56" r="4" fill="#3B2F2F"/>
          <circle cx="72" cy="56" r="4" fill="#3B2F2F"/>
          <path d="M58 40l8-14" stroke="#FFB3D2" stroke-width="4" stroke-linecap="round"/>
        </g></svg>`;
      return "";
    }

    // ---- Seis ----
    let wallet = 0;           // cents
    let selected = new Set(); // ids

    // ---- DOM ----
    const $wallet = document.getElementById("wallet");
    const $walletBreakdown = document.getElementById("walletBreakdown");
    const $change = document.getElementById("change");
    const $changeBreakdown = document.getElementById("changeBreakdown");
    const $selTotal = document.getElementById("selTotal");
    const $afford = document.getElementById("afford");
    const $shop = document.getElementById("shop");
    const $coinsOnly = document.getElementById("coinsOnly");

    // Pood
    function renderShop(){
      $shop.innerHTML = "";
      PLUSHIES.forEach(p => {
        const el = document.createElement("button");
        el.className = "item";
        el.innerHTML = `
          <div>${svg(p.svg)}</div>
          <div>${p.name}</div>
          <div class="price">${‚Ç¨(p.priceCents)}</div>
        `;
        el.setAttribute("aria-pressed", selected.has(p.id) ? "true" : "false");
        if(selected.has(p.id)) el.classList.add("selected");
        el.onclick = () => {
          if(selected.has(p.id)) selected.delete(p.id);
          else selected.add(p.id);
          renderAll();
        };
        $shop.appendChild(el);
      });
    }

    function breakdownList(centSum, coinsOnly=false){
      const list = greedyBreakdown(centSum, coinsOnly);
      if(list.length === 0) return "<li>‚Äî</li>";
      return list.map(b => `<li>${b.count} √ó ${b.label}</li>`).join("");
    }

    function renderTotals(){
      const sel = Array.from(selected).map(id => PLUSHIES.find(p => p.id===id));
      const selSum = sel.reduce((a,p) => a + (p ? p.priceCents : 0), 0);
      $selTotal.textContent = ‚Ç¨(selSum);

      const can = wallet >= selSum;
      $afford.textContent = can ? "Jah" : "Ei";
      $afford.className = can ? "state-ok" : "state-bad";

      const ch = can ? (wallet - selSum) : 0;
      $change.textContent = ‚Ç¨(can ? ch : 0);
      $changeBreakdown.innerHTML = can
        ? breakdownList(ch, $coinsOnly.checked)
        : "<li>Ei ole ostetud ‚Äî vahetust ei arvutata.</li>";
    }

    function renderWallet(){
      $wallet.textContent = ‚Ç¨(wallet);
      if(wallet === 0){
        $walletBreakdown.innerHTML = '<li>Puudub raha ‚Äî vajuta ‚ÄúAnna ‚Ç¨5‚Äù v√µi ‚ÄúAnna ‚Ç¨10‚Äù.</li>';
      } else {
        $walletBreakdown.innerHTML = breakdownList(wallet, $coinsOnly.checked);
      }
    }

    function renderAll(){
      renderShop();
      renderWallet();
      renderTotals();
    }

    // ---- Nupud ----
    document.getElementById("give5").onclick  = () => { wallet = 500; selected.clear(); renderAll(); };
    document.getElementById("give10").onclick = () => { wallet = 1000; selected.clear(); renderAll(); };
    document.getElementById("clear").onclick  = () => { wallet = 0; selected.clear(); renderAll(); };
    $coinsOnly.onchange = () => { renderWallet(); renderTotals(); };

    // start
    renderAll();
  </script>
</body>
</html>
